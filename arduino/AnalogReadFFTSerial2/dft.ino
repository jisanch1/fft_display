const double tsin[] = {
  0.0,
  0.19509032,
  0.38268343,
  0.55557023,
  0.70710678,
  0.83146961,
  0.92387953,
  0.98078528,
  1.0,
  0.98078528,
  0.92387953,
  0.83146961,
  0.70710678,
  0.55557023,
  0.38268343,
  0.19509032,
  0.0,
  -0.19509032,
  -0.38268343,
  -0.55557023,
  -0.70710678,
  -0.83146961,
  -0.92387953,
  -0.98078528,
  -1.0,
  -0.98078528,
  -0.92387953,
  -0.83146961,
  -0.70710678,
  -0.55557023,
  -0.38268343,
  -0.19509032
};

const double tcos[] = {
  1.0,
  0.98078528,
  0.92387953,
  0.83146961,
  0.70710678,
  0.55557023,
  0.38268343,
  0.19509032,
  0.0,
  -0.19509032,
  -0.38268343,
  -0.55557023,
  -0.70710678,
  -0.83146961,
  -0.92387953,
  -0.98078528,
  -1.0,
  -0.98078528,
  -0.92387953,
  -0.83146961,
  -0.70710678,
  -0.55557023,
  -0.38268343,
  -0.19509032,
  0.0,
  0.19509032,
  0.38268343,
  0.55557023,
  0.70710678,
  0.83146961,
  0.92387953,
  0.98078528,
};

void dft(double *input_buf, double *real_buf, double *imag_buf, int n)
{
  uint16_t i, j, k;
  for (i = 0; i < n; i++)
  {
    real_buf[i] = 0;
    imag_buf[i] = 0;
    for (j = 0; j < n; j++)
    {
      k = (i*j) % n;
      real_buf[i] += input_buf[j]*tcos[k];
      imag_buf[i] -= input_buf[j]*tsin[k];
    }
  }
}
